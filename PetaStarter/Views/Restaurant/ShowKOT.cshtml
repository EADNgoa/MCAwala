@model IEnumerable<KOTscreen>
@{
    Layout = null;
}

<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>KOT screen</title>
    <link rel="icon" href="~/Custom/BBS.ico">
    @Styles.Render("~/Content/themes/base/css")
    @Scripts.Render("~/bundles/modernizr")
    @Styles.Render("~/Content/css")
    @Scripts.Render("~/bundles/jquery")
</head>
<body>
    @if (ViewBag.OurRestaurants != null)
    {
        <h3>Please select the Restaurant</h3>
        using (Html.BeginForm("ShowKOT", "Restaurant", FormMethod.Get))
        {
            @Html.DropDownList("LocationId", (IEnumerable<SelectListItem>)ViewBag.OurRestaurants, "Select restaurant",new { @class="form-control"})
            <br />
            <input type="submit" value="Fetch" class="btn btn-default" />
        }

    }
    else
    {
        <h1>KOTs at @ViewBag.RestaurantName</h1>
        <hr />
        <div>
            @foreach (var item in Model)
            {
                @Html.Partial("KOT", item)
            }
        </div>
    }
    @Scripts.Render("~/bundles/bootstrap")
    <script>
        $(function () {
            $('.ClickActive').click(function() {                
                $.post('@Url.Action("KOtitemReady")', { id: $(this).data('val')});
                    $(this).parent().css("background-color", "green");
                    $(this).hide();

                //Check if all items are ready                    
                    if ($('.table-' + $(this).data('kot') + ' .ClickActive:checked').length == $('.table-' + $(this).data('kot') + ' .ClickActive').length) {
                        $('.table-' + $(this).data('kot')).delay(800).slideUp(8010);
                        location.href = location.href;
                    } 

            });
        });
    </script>
</body>
</html>
